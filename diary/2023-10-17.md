&nbsp;둘째 날에는 <b>tmdb database download</b>라는 키워드로 샘플 데이터를 다운로드 받고 가공하는 작업을 했습니다.

&nbsp;어제는 mysql 도커 이미지를 만들고 샘플데이터를 공유하면되겠다고 생각했습니다. mysql 컨테이너를 실행하고 초기 테이블을 만든 후 컨테이너를 이미지로 저장했습니다. 만든 이미지를 docker hub에 push하고 다시 다운로드 받아서 실행시켜보니 초기 테이블이 저장은 안 되고 사라져버렸습니다. 데이터 파일을 저장하려면 도커의 volume을 사용해야함을 간과한 것이었습니다. 볼륨 데이터를 확인해보니 데이터 용량이 150mb가 되었고 이는 git repo에 포함하기는 부적합해보였고 mysqldump로 insert 쿼리를 추출하는 방법이 적합해보였습니다.

&nbsp;다음으로 캐글에서 다운로드 받은 json 파일을 가공하는 파이썬 스크립트를 작성했습니다. 테이블 단위로 데이터를 추출해서 새로운 json 파일을 만들고 이 파일을 [JSON to Insert SQL](https://www.convertjson.com/json-to-sql.htm)을 이용해서 insert 쿼리로 변경했습니다. 이렇게 만든 insert 쿼리는 flywaydb migration에 등록하면 샘플 데이터의 공유 문제도 자연스럽게 해결되겠다는 생각이 들었습니다.

&nbsp;전체 데이터는 약 500000건으로 봤는데 그 중 대략 2500건 정도 사용했습니다. 중간에 확인해보니 영화 제목이 중복되는 데이터도 있었고 스칼라 서브쿼리가 위치해야하는 자리에 여러 건의 데이터를 반환한다는 에러 메시지가 있었습니다. 이 때 유일성을 확보하기 위해 tmdb에서 사용하는 id 값을 별도의 칼럼으로 보관해뒀으면 좋았을 것 같다는 생각에 아쉬움이 남았습니다.